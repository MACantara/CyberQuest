export class BaseMalware {
    constructor(config) {
        this.name = config.name || 'Unknown Malware';
        this.type = config.type || 'Unknown';
        this.riskLevel = config.riskLevel || 'Medium';
        this.size = config.size || '1.0 MB';
        this.path = config.path || 'C:\\Unknown\\path';
        this.description = config.description || 'Unknown malware threat';
        this.signatures = config.signatures || [];
        this.behavior = config.behavior || [];
        this.origin = config.origin || 'Unknown';
        this.discovered = config.discovered || new Date().toISOString();
    }

    // Convert to object format for scanner results
    toThreatObject() {
        return {
            id: Math.random().toString(36).substr(2, 9),
            name: this.name,
            type: this.type,
            riskLevel: this.riskLevel,
            size: this.size,
            path: this.path,
            description: this.description,
            signatures: this.signatures,
            behavior: this.behavior,
            origin: this.origin,
            detected: new Date().toLocaleString(),
            discovered: this.discovered
        };
    }

    // Get detailed analysis report
    getAnalysisReport() {
        return {
            name: this.name,
            type: this.type,
            riskLevel: this.riskLevel,
            size: this.size,
            path: this.path,
            description: this.description,
            signatures: this.signatures,
            behavior: this.behavior,
            origin: this.origin,
            recommendations: this.getRemovalRecommendations(),
            prevention: this.getPreventionTips()
        };
    }

    // Get removal recommendations (override in child classes)
    getRemovalRecommendations() {
        return [
            'Quarantine the infected file immediately',
            'Run a full system scan',
            'Update antivirus definitions',
            'Restart the system in safe mode if necessary'
        ];
    }

    // Get prevention tips (override in child classes)
    getPreventionTips() {
        return [
            'Keep antivirus software updated',
            'Avoid suspicious downloads',
            'Use trusted software sources',
            'Enable real-time protection'
        ];
    }

    // Check if file path matches this malware
    matchesPath(filePath) {
        return filePath.includes(this.getFileName());
    }

    // Get just the filename from the path
    getFileName() {
        return this.path.split('\\').pop();
    }

    // Get malware category for filtering
    getCategory() {
        return this.type.toLowerCase();
    }

    // Check severity level
    isCritical() {
        return this.riskLevel.toLowerCase() === 'critical';
    }

    isHigh() {
        return this.riskLevel.toLowerCase() === 'high';
    }

    isMedium() {
        return this.riskLevel.toLowerCase() === 'medium';
    }

    isLow() {
        return this.riskLevel.toLowerCase() === 'low';
    }
}
