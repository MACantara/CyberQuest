import { ActivityEmitterBase } from '../../activity-emitter-base.js';

export class MalwareScannerActivityEmitter extends ActivityEmitterBase {
    constructor(appId, appName) {
        super(appId, appName);
    }

    initializeCustomEvents() {
        console.log(`[${this.appName}] Malware scanner activity events initialized`);
    }

    emitScanStarted() {
        this.emitActivity('malware_scan_started', {
            action: 'scan_initiated',
            scanType: 'quick'
        }, {
            message: 'Malware scan started - checking system for threats',
            level: 'info',
            category: 'security'
        });
    }

    emitScanCompleted(threatsFound) {
        this.emitActivity('malware_scan_completed', {
            action: 'scan_finished',
            threatsFound
        }, {
            message: `Malware scan completed - ${threatsFound} threats detected`,
            level: threatsFound > 0 ? 'warn' : 'info',
            category: 'security'
        });
    }

    emitThreatDetected(threat) {
        this.emitActivity('threat_detected', {
            threatName: threat.name,
            threatType: threat.type,
            riskLevel: threat.riskLevel,
            path: threat.path
        }, {
            message: `Threat detected: ${threat.name} (${threat.type}) at ${threat.path}`,
            level: 'error',
            category: 'security',
            threat_level: threat.riskLevel.toLowerCase()
        });
    }

    emitThreatQuarantined(threat) {
        this.emitActivity('threat_quarantined', {
            threatName: threat.name,
            threatType: threat.type,
            action: 'quarantine'
        }, {
            message: `Threat quarantined: ${threat.name} safely isolated`,
            level: 'info',
            category: 'security'
        });
    }

    emitThreatDeleted(threat) {
        this.emitActivity('threat_deleted', {
            threatName: threat.name,
            threatType: threat.type,
            action: 'delete'
        }, {
            message: `Threat deleted: ${threat.name} permanently removed`,
            level: 'warn',
            category: 'security'
        });
    }

    emitMalwareCleanupComplete(quarantinedCount) {
        this.emitActivity('malware_cleanup_complete', {
            action: 'cleanup_finished',
            threatsQuarantined: quarantinedCount
        }, {
            message: `Malware cleanup completed successfully - ${quarantinedCount} threats quarantined`,
            level: 'info',
            category: 'security'
        });
    }

    emitThreatRestored(threat) {
        this.emitActivity('threat_restored', {
            threatName: threat.name,
            threatType: threat.type,
            action: 'restore'
        }, {
            message: `Threat restored from quarantine: ${threat.name}`,
            level: 'warn',
            category: 'security'
        });
    }

    emitDefinitionsUpdated() {
        this.emitActivity('definitions_updated', {
            action: 'security_update',
            updateType: 'virus_definitions'
        }, {
            message: 'Virus definitions updated successfully',
            level: 'info',
            category: 'security'
        });
    }

    emitScanTypeChanged(scanType) {
        this.emitActivity('scan_type_changed', {
            action: 'configuration_change',
            scanType
        }, {
            message: `Scan type changed to: ${scanType}`,
            level: 'debug',
            category: 'configuration'
        });
    }

    emitQuarantineCleared(itemCount) {
        this.emitActivity('quarantine_cleared', {
            action: 'quarantine_management',
            itemsCleared: itemCount
        }, {
            message: `Quarantine cleared - ${itemCount} items removed`,
            level: 'info',
            category: 'security'
        });
    }
}
